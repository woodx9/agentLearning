# QuickStar - 智能上下文代理

[English Version](./README.md)

基于 ReAct（推理与行动）模式的 AI 代理系统，支持实时流式输出、智能历史管理、成本跟踪、智能上下文裁剪和结构化任务管理。

## 🚀 Chapter 6 新特性

Chapter 6 引入了 **TodoWrite 工具** - 一个智能任务管理系统，能够自动将复杂工作流程组织成结构化的待办事项列表，并提供实时进度跟踪。

### 核心优势
- **自动化组织**：将复杂请求转换为结构化任务列表
- **进度可视化**：实时跟踪任务完成状态
- **质量保证**：防止在所有要求未满足前标记任务完成
- **上下文感知**：智能判断何时使用待办事项列表最有价值

## 🛠️ TodoWrite 工具

### 核心功能
- **任务状态**：`pending` → `in_progress` → `completed`
- **智能检测**：自动激活多步骤任务（3个以上操作）
- **单一焦点**：同时只能有一个任务处于 `in_progress` 状态
- **完成验证**：仅当测试通过且要求完全满足时才标记任务完成

### 激活时机
```bash
# 多步骤功能请求
用户："添加暗黑模式切换，运行测试，构建应用"
→ 自动创建结构化待办事项列表

# 多功能请求
用户："实现用户注册、产品目录、购物车"
→ 分解为有组织的子任务

# 复杂调试工作流
用户："修复API延迟问题并优化性能"
→ 创建系统性调查计划
```

### 使用示例

**功能开发**：
```python
# 自动为复杂功能创建
[
  {"content": "创建认证API端点", "status": "pending"},
  {"content": "构建登录/注册UI组件", "status": "pending"}, 
  {"content": "实现会话管理", "status": "pending"},
  {"content": "添加安全中间件和测试", "status": "pending"}
]
```

**错误修复工作流**：
```python
# 系统性调试方法
[
  {"content": "在开发环境重现问题", "status": "in_progress"},
  {"content": "识别根本原因", "status": "pending"},
  {"content": "实现修复并编写测试", "status": "pending"},
  {"content": "在预发布环境验证", "status": "pending"}
]
```

## 📊 功能演进

| 能力 | Chapter 4 | Chapter 5 | Chapter 6 |
|------|-----------|-----------|-----------|
| 流式输出 | ✅ | ✅ | ✅ |
| 历史管理 | ✅ | ✅ | ✅ |
| 智能裁剪 | ❌ | ✅ | ✅ |
| 用户交互 | 基础 | 增强 | 增强 |
| **任务管理** | ❌ | ❌ | **✅ TodoWrite** |
| **进度跟踪** | 手动 | 手动 | **✅ 自动化** |

## 🧪 测试

```bash
# 测试 TodoWrite 功能
python test/test_todo_write.py

# 测试智能裁剪
python test/test_crop_message.py

# 测试历史压缩
python test/test_history_compress.py
```

## 🎯 架构理念

**思考 → 行动 → 验证**

1. **思考**：AI 通过 TodoWrite 分析请求并创建结构化计划
2. **行动**：通过工具调用系统性地执行任务
3. **验证**：对可能有风险的操作要求用户确认

TodoWrite 工具通过提供透明的任务组织、进度跟踪和完成验证来增强这一流程，确保复杂工作流能够系统性且可靠地处理。

## 快速开始

1. 克隆代码库
2. 安装依赖
3. 启用 TodoWrite 运行代理
4. 观察复杂请求如何自动组织成可管理的任务列表

系统智能地决定何时使用结构化任务管理，使其对简单查询和复杂多步骤工作流都非常流畅。
